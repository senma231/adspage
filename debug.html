<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜çº§è°ƒè¯•å·¥å…· - TechLife Blog</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
        .debug-container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        .debug-section { margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 4px; border-left: 4px solid #007bff; }
        .status { padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        .info { background: #d1ecf1; color: #0c5460; }
        button { padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #0056b3; }
        .log { background: #212529; color: #28a745; padding: 15px; border-radius: 4px; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto; }
        .selector-check { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; }
        .check-item { padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="debug-container">
        <h1>ğŸ” åŠ¨æ€å†…å®¹ç³»ç»Ÿè°ƒè¯•å·¥å…·</h1>
        
        <div class="debug-section">
            <h3>ğŸ¯ é€‰æ‹©å™¨æ£€æŸ¥</h3>
            <button onclick="checkSelectors()">æ£€æŸ¥æ‰€æœ‰é€‰æ‹©å™¨</button>
            <div id="selectorResults" class="selector-check"></div>
        </div>
        
        <div class="debug-section">
            <h3>ğŸ“¡ APIè¿æ¥æµ‹è¯•</h3>
            <button onclick="testAPIsDetailed()">è¯¦ç»†APIæµ‹è¯•</button>
            <div id="apiResults"></div>
        </div>
        
        <div class="debug-section">
            <h3>ğŸ”„ å†…å®¹åŠ è½½æµ‹è¯•</h3>
            <button onclick="loadContentWithDebug()">è°ƒè¯•æ¨¡å¼åŠ è½½å†…å®¹</button>
            <button onclick="clearConsoleLog()">æ¸…é™¤æ—¥å¿—</button>
            <div id="consoleLog" class="log">ç­‰å¾…è°ƒè¯•ä¿¡æ¯...</div>
        </div>
        
        <div class="debug-section">
            <h3>ğŸ“Š ç³»ç»ŸçŠ¶æ€</h3>
            <div id="systemStatus">
                <div class="info">ç³»ç»Ÿå¯åŠ¨ä¸­...</div>
            </div>
        </div>
    </div>

    <script src="content-loader.js"></script>
    <script>
        let debugLog = [];
        
        // é‡å†™console.logæ¥æ•è·æ‰€æœ‰æ—¥å¿—
        const originalConsoleLog = console.log;
        const originalConsoleError = console.error;
        
        console.log = function(...args) {
            debugLog.push({ type: 'log', message: args.join(' '), time: new Date().toLocaleTimeString() });
            updateConsoleDisplay();
            originalConsoleLog.apply(console, args);
        };
        
        console.error = function(...args) {
            debugLog.push({ type: 'error', message: args.join(' '), time: new Date().toLocaleTimeString() });
            updateConsoleDisplay();
            originalConsoleError.apply(console, args);
        };
        
        function updateConsoleDisplay() {
            const logEl = document.getElementById('consoleLog');
            logEl.innerHTML = debugLog.slice(-20).map(log => 
                `<div style="color: ${log.type === 'error' ? '#dc3545' : '#28a745'}">[${log.time}] ${log.message}</div>`
            ).join('');
            logEl.scrollTop = logEl.scrollHeight;
        }
        
        function clearConsoleLog() {
            debugLog = [];
            updateConsoleDisplay();
        }
        
        function checkSelectors() {
            const selectors = [
                '#latest .blog-posts',
                '#reviews .blog-posts', 
                '.popular-posts',
                '#latest',
                '#reviews',
                '.section',
                '.blog-post'
            ];
            
            let html = '';
            selectors.forEach(selector => {
                const element = document.querySelector(selector);
                const elements = document.querySelectorAll(selector);
                const exists = !!element;
                const count = elements.length;
                
                html += `
                    <div class="check-item ${exists ? 'success' : 'error'}">
                        <strong>${selector}</strong><br>
                        å­˜åœ¨: ${exists ? 'âœ…' : 'âŒ'}<br>
                        æ•°é‡: ${count}<br>
                        ${element ? `æ ‡ç­¾: ${element.tagName}` : ''}
                    </div>
                `;
            });
            
            document.getElementById('selectorResults').innerHTML = html;
        }
        
        async function testAPIsDetailed() {
            const results = document.getElementById('apiResults');
            results.innerHTML = '<div class="info">æ­£åœ¨æµ‹è¯•APIè¿æ¥...</div>';
            
            const apis = [
                {
                    name: 'Dev.to API',
                    url: 'https://dev.to/api/articles?tag=javascript&top=7',
                    description: 'è·å–JavaScriptçƒ­é—¨æ–‡ç« '
                },
                {
                    name: 'GitHub Trending',
                    url: 'https://api.github.com/search/repositories?q=language:javascript+stars:>100&sort=updated&per_page=3',
                    description: 'è·å–JavaScriptçƒ­é—¨ä»“åº“'
                },
                {
                    name: 'RSSè½¬JSONæœåŠ¡',
                    url: 'https://api.rss2json.com/v1/api.json?rss_url=https://techcrunch.com/feed/',
                    description: 'è·å–TechCrunch RSS'
                }
            ];
            
            let html = '<h4>APIæµ‹è¯•ç»“æœ:</h4>';
            
            for (const api of apis) {
                try {
                    const startTime = Date.now();
                    const response = await fetch(api.url);
                    const endTime = Date.now();
                    const duration = endTime - startTime;
                    
                    if (response.ok) {
                        const data = await response.json();
                        let itemCount = 0;
                        if (Array.isArray(data)) itemCount = data.length;
                        else if (data.items) itemCount = data.items.length;
                        else if (data.total_count !== undefined) itemCount = data.total_count;
                        
                        html += `
                            <div class="success">
                                âœ… <strong>${api.name}</strong> (${duration}ms)<br>
                                ${api.description}<br>
                                æ•°æ®é¡¹: ${itemCount}<br>
                                çŠ¶æ€: ${response.status} ${response.statusText}
                            </div>
                        `;
                    } else {
                        html += `
                            <div class="error">
                                âŒ <strong>${api.name}</strong><br>
                                HTTPé”™è¯¯: ${response.status} ${response.statusText}<br>
                                ${api.description}
                            </div>
                        `;
                    }
                } catch (error) {
                    html += `
                        <div class="error">
                            âŒ <strong>${api.name}</strong><br>
                            ç½‘ç»œé”™è¯¯: ${error.message}<br>
                            ${api.description}
                        </div>
                    `;
                }
            }
            
            results.innerHTML = html;
        }
        
        async function loadContentWithDebug() {
            console.log('ğŸ” å¼€å§‹è°ƒè¯•æ¨¡å¼å†…å®¹åŠ è½½...');
            
            // æ£€æŸ¥å†…å®¹åŠ è½½å™¨æ˜¯å¦å­˜åœ¨
            if (!window.techContentLoader) {
                console.error('âŒ techContentLoaderæœªæ‰¾åˆ°!');
                return;
            }
            
            console.log('âœ… techContentLoaderå·²åŠ è½½');
            
            // æ£€æŸ¥å…³é”®é€‰æ‹©å™¨
            const latestSection = document.querySelector('#latest .blog-posts');
            const reviewsSection = document.querySelector('#reviews .blog-posts');
            const popularPosts = document.querySelector('.popular-posts');
            
            console.log('é€‰æ‹©å™¨æ£€æŸ¥ç»“æœ:');
            console.log('- #latest .blog-posts:', !!latestSection);
            console.log('- #reviews .blog-posts:', !!reviewsSection); 
            console.log('- .popular-posts:', !!popularPosts);
            
            if (!latestSection) {
                console.error('âŒ Latest section é€‰æ‹©å™¨æœªæ‰¾åˆ°!');
                console.log('å°è¯•æŸ¥æ‰¾å¤‡ç”¨é€‰æ‹©å™¨...');
                const altLatest = document.querySelector('#latest');
                console.log('- #latest å­˜åœ¨:', !!altLatest);
                if (altLatest) {
                    console.log('- #latest å†…å®¹:', altLatest.innerHTML.substring(0, 200));
                }
            }
            
            if (!reviewsSection) {
                console.error('âŒ Reviews section é€‰æ‹©å™¨æœªæ‰¾åˆ°!');
                console.log('å°è¯•æŸ¥æ‰¾å¤‡ç”¨é€‰æ‹©å™¨...');
                const altReviews = document.querySelector('#reviews');
                console.log('- #reviews å­˜åœ¨:', !!altReviews);
                if (altReviews) {
                    console.log('- #reviews å†…å®¹:', altReviews.innerHTML.substring(0, 200));
                }
            }
            
            // æ‰‹åŠ¨è§¦å‘å†…å®¹åŠ è½½
            try {
                await window.techContentLoader.loadContent();
                console.log('âœ… å†…å®¹åŠ è½½å®Œæˆ!');
            } catch (error) {
                console.error('âŒ å†…å®¹åŠ è½½å¤±è´¥:', error);
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
        window.addEventListener('load', () => {
            setTimeout(() => {
                const status = document.getElementById('systemStatus');
                let html = '';
                
                if (window.techContentLoader) {
                    html += '<div class="success">âœ… åŠ¨æ€å†…å®¹åŠ è½½å™¨å·²åˆå§‹åŒ–</div>';
                    html += '<div class="info">ğŸ“Š ç¼“å­˜çŠ¶æ€: ' + (window.techContentLoader.cache.data ? 'æœ‰æ•°æ®' : 'æ— æ•°æ®') + '</div>';
                } else {
                    html += '<div class="error">âŒ åŠ¨æ€å†…å®¹åŠ è½½å™¨æœªæ‰¾åˆ°</div>';
                }
                
                html += '<div class="info">ğŸŒ é¡µé¢: ' + window.location.href + '</div>';
                html += '<div class="info">ğŸ“± ç”¨æˆ·ä»£ç†: ' + navigator.userAgent.substring(0, 100) + '</div>';
                
                status.innerHTML = html;
                
                // è‡ªåŠ¨è¿è¡Œé€‰æ‹©å™¨æ£€æŸ¥
                setTimeout(checkSelectors, 1000);
            }, 2000);
        });
    </script>
</body>
</html>